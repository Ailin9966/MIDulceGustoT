<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Formulario de Pedido</title>
  <link rel="stylesheet" href="formulario1.css" />
</head>
<body>

  <div class="formulario-contenedor">
    <h1>Regístrate y Envía tu Pedido</h1>
    <form action="procesar.php" method="POST">
      <label for="nombre">Nombre:</label>
      <input type="text" name="nombre" id="nombre" required />

      <label for="correo">Correo electrónico:</label>
      <input type="email" name="correo" id="correo" required />

      <label for="fecha">¿Para cuándo quieres tu pedido?</label>
      <input type="date" name="fecha" id="fecha" required />

      <label for="pedido">Tu pedido:</label>
      <textarea name="pedido" id="pedido" rows="6" readonly required></textarea>

      <button type="submit">Enviar Pedido</button>
    </form>
  </div>
<div class="contenedor-boton">
  <a href="index.html" class="boton-regresar">🌸 Página Inicio</a>
</div>

<!-- EmailJS SDK -->
<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>
  // Inicializa con tu user ID de EmailJS
  emailjs.init("service_gtzc1jr");

  const form = document.getElementById("pedido-form");
  const pedidoCampo = document.getElementById("pedido");

  const carrito = JSON.parse(localStorage.getItem("carrito")) || [];

  if (carrito.length > 0) {
    const resumen = carrito.map(p => `${p.nombre} - $${p.precio}`).join("\n");
    const total = carrito.reduce((acc, p) => acc + p.precio, 0);
    pedidoCampo.value = `${resumen}\n\nTotal: $${total.toFixed(2)} MXN`;
  } else {
    pedidoCampo.value = "Tu carrito está vacío.";
  }

  form.addEventListener("submit", function(e) {
    e.preventDefault();

    emailjs.sendForm("service_gtzc1jr", "template_cazd92d", this)
      .then(() => {
        alert("✅ Pedido enviado correctamente.");
        localStorage.removeItem("carrito");
        window.location.href = "inicio.html";
      }, (error) => {
        alert("❌ Error al enviar: " + JSON.stringify(error));
      });
  });
</script>

  </script>

</body>
</html>


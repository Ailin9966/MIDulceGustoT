<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Formulario de Pedido</title>
  <link rel="stylesheet" href="formulario1.css" />
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
</head>
<body>

  <div class="formulario-contenedor">
    <h1>Regístrate y Envía tu Pedido</h1>
    <form id="pedido-form">
      <label for="nombre">Nombre:</label>
      <input type="text" name="nombre" id="nombre" required />

      <label for="correo">Correo electrónico:</label>
      <input type="email" name="correo" id="correo" required />

      <label for="fecha">¿Para cuándo quieres tu pedido?</label>
      <input type="date" name="fecha" id="fecha" required />

      <label for="pedido">Tu pedido:</label>
      <textarea name="pedido" id="pedido" rows="6" required></textarea>

      <button type="submit" class="boton-pagar">Encargar 💌</button>
    </form>
  </div>

  <div class="contenedor-boton" style="text-align:center; margin-top: 30px;">
    <a href="index.html" class="boton-regresar">🌸 Página Inicio</a>
  </div>

  <script>
    // Inicializar EmailJS con tu Public Key real
    emailjs.init("8WK-K2H7FQwWPoka7");

    const formulario = document.getElementById("pedido-form");
    const campoPedido = document.getElementById("pedido");

    // Obtener el carrito desde localStorage y mostrar el contenido
    const carrito = JSON.parse(localStorage.getItem("carrito")) || [];

    if (carrito.length > 0) {
      const resumen = carrito.map(item => `• ${item.nombre} - $${item.precio}`).join('\n');
      const total = carrito.reduce((sum, item) => sum + item.precio, 0);
      campoPedido.value = `${resumen}\n\nTotal: $${total.toFixed(2)} MXN`;
    } else {
      campoPedido.value = "Tu carrito está vacío.";
    }

    // Enviar el formulario con EmailJS
    formulario.addEventListener("submit", function (e) {
      e.preventDefault();

      // Asegurar que el campo 'pedido' esté actualizado antes del envío
      formulario.pedido.value = campoPedido.value;

      emailjs.sendForm("service_g3ax8dn", "template_752ioo9", formulario)
        .then(() => {
          alert("✅ Pedido enviado correctamente.");
          localStorage.removeItem("carrito");
          window.location.href = "index.html";
        }, (error) => {
          alert("❌ Error al enviar: " + JSON.stringify(error));
        });
    });
  </script>

</body>
</html>


</body>
</html>



